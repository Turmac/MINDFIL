str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, value) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>%
left_join(questions_info, by = "q_id") %>%
mutate(grade = ifelse(user_answer == q_answer, 1, 0),
sample = as.integer(u_id)%%10) %>%
select(-type,-timestamp, -extra) %>%
mutate_if(is.character,as.integer)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test)
# question level user
user_questions_data <-
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>%
left_join(questions_info, by = "q_id") %>%
mutate(grade = ifelse(user_answer == q_answer, 1, 0),
sample = as.integer(u_id)%%10) %>%
select(-type,-timestamp, -extra) %>%
mutate_if(is.character,as.integer)
user_questions_data
user_questions_data %>% count(u_id, T)
user_questions_data %>% count(u_id, sort = T)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup()
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>% count(u_id, sort = T)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup()
1006/36
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>% count(u_id) %>% arrange(n)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>%
left_join(questions_info, by = "q_id")
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup()
actual_questions_data
questions_info <-
actual_questions_data %>%
select(q_id = `Group ID`,
q_answer = Same,
q_type = `Record ID`) %>%
group_by(q_id) %>%
slice(1) %>%
ungroup() %>%
mutate_all(as.integer)
# each cell click info
raw_user_data %>%
filter(type == "kapr",
str_detect(extra, "record_linkage")) %>%
mutate(url = str_extract(extra, "url" %R% one_or_more(or(PUNCT, WRD))) %>% str_replace("url:", ""),
open_cell = str_extract(extra, "id:" %R% one_or_more(or(DGT, literal("-")))) %>% str_replace("id:", ""),
id = str_extract(open_cell, one_or_more(DGT)),
column_id = str_extract(open_cell, DGT %R% END) %>% as.integer(),
column = case_when(
column_id == 0 ~ "reg",
column_id == 1 ~ "fname",
column_id == 2 ~ "lname",
column_id == 3 ~ "dob",
column_id == 4 ~ "sex",
TRUE ~ "race"
)) %>%
arrange(uid, timestamp) %>%
select(u_id = uid, kapr = value, q_id = id, column)
# kapr for each user
user_kapr <-
raw_user_data %>%
filter(type == "kapr",
str_detect(extra, "record_linkage")) %>%
mutate(mode_url = extra %>% str_replace("id:" %R% one_or_more(or(DGT,PUNCT)), ""),
value = value %>% as.numeric()) %>%
group_by(uid) %>%
filter(value == max(value)) %>%
ungroup() %>%
arrange(uid) %>%
select(u_id = uid, kapr = value)
attention_test <- c(1,7,13,19,25,31)
# question level user
user_questions_data <-
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>%
left_join(questions_info, by = "q_id") %>%
mutate(grade = ifelse(user_answer == q_answer, 1, 0),
sample = as.integer(u_id)%%10) %>%
select(-type,-timestamp, -extra) %>%
mutate_if(is.character,as.integer)
user_questions_data %>%
group_by(u_id, sample) %>%
summarise(grade36 = sum(grade),
grade30 = sum(grade[!(q_type %in% attention_test)]),
percent_attention = mean(grade[q_type %in% attention_test]),
percent_attention = ifelse(is.nan(percent_attention), 1, percent_attention),
percent36 = mean(grade)*100,
percent30 = mean(grade[!(q_type %in% attention_test)]) *100,
mean_confidence = mean(confidence),
mean_confidence_right = mean(confidence[grade == 1]),
mean_confidence_wrong = mean(confidence[grade == 0])) %>%
left_join(user_kapr, "u_id")
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup()
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>%
left_join(questions_info, by = "q_id")
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>%
left_join(questions_info, by = "q_id") %>%
mutate(grade = ifelse(user_answer == q_answer, 1, 0),
sample = as.integer(u_id)%%10)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>%
left_join(questions_info, by = "q_id") %>%
mutate(grade = ifelse(user_answer == q_answer, 1, 0),
sample = as.integer(u_id)%%10) %>%
select(-type,-timestamp, -extra) %>%
mutate_if(is.character,as.integer)
# question level user
user_questions_data <-
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>%
left_join(questions_info, by = "q_id") %>%
mutate(grade = ifelse(user_answer == q_answer, 1, 0),
sample = as.integer(u_id)%%10) %>%
select(-type,-timestamp, -extra) %>%
mutate_if(is.character,as.integer)
user_questions_data %>%
group_by(u_id, sample) %>%
summarise(grade36 = sum(grade),
grade30 = sum(grade[!(q_type %in% attention_test)]),
percent_attention = mean(grade[q_type %in% attention_test]),
percent_attention = ifelse(is.nan(percent_attention), 1, percent_attention),
percent36 = mean(grade)*100,
percent30 = mean(grade[!(q_type %in% attention_test)]) *100,
mean_confidence = mean(confidence),
mean_confidence_right = mean(confidence[grade == 1]),
mean_confidence_wrong = mean(confidence[grade == 0])) %>%
left_join(user_kapr, "u_id")
user_questions_data
View(user_questions_data)
key_info <-
user_questions_data %>%
group_by(u_id, sample) %>%
summarise(grade36 = sum(grade),
grade30 = sum(grade[!(q_type %in% attention_test)]),
percent_attention = mean(grade[q_type %in% attention_test]),
percent_attention = ifelse(is.nan(percent_attention), 1, percent_attention),
percent36 = mean(grade)*100,
percent30 = mean(grade[!(q_type %in% attention_test)]) *100,
mean_confidence = mean(confidence),
mean_confidence_right = mean(confidence[grade == 1]),
mean_confidence_wrong = mean(confidence[grade == 0])) %>%
left_join(user_kapr, "u_id")
key_info
View(key_info)
raw_user_data %>% filter(str_detect(type, "performance"))
raw_user_data %>% filter(str_detect(type, "performance1"))
raw_user_data %>% filter(str_detect(type, "performance1")) %>% arrange(uid)
raw_user_data
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage"))
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>% count(uid, sort = T)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>% count(u_id, sort = T)
raw_user_data %>% filter(str_detect(type, "performance1")) %>% arrange(uid)
key_info
key_info %>% summarise_all(mean)
key_info %>%
filter(uid != 2) %>%
mutate(mode = str_sub(u_id,1,1))
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1))
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
group_by(mode) %>%
summarise_all(mean)
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
group_by(mode) %>%
summarise_all(mean) %>%
View
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
group_by(mode)
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
group_by(mode) %>% count(n = n())
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
count(n = n())
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
count(u_id)
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
count(mode)
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
count(mode)
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
count(mode)
key_info %>%
filter(u_id != 2) %>%
mutate(mode = str_sub(u_id,1,1)) %>%
group_by(mode) %>%
summarise(n = n())
user_kapr
user_kapr
# each cell click info
raw_user_data %>%
filter(type == "kapr",
str_detect(extra, "record_linkage")) %>%
mutate(url = str_extract(extra, "url" %R% one_or_more(or(PUNCT, WRD))) %>% str_replace("url:", ""),
open_cell = str_extract(extra, "id:" %R% one_or_more(or(DGT, literal("-")))) %>% str_replace("id:", ""),
id = str_extract(open_cell, one_or_more(DGT)),
column_id = str_extract(open_cell, DGT %R% END) %>% as.integer(),
column = case_when(
column_id == 0 ~ "reg",
column_id == 1 ~ "fname",
column_id == 2 ~ "lname",
column_id == 3 ~ "dob",
column_id == 4 ~ "sex",
TRUE ~ "race"
)) %>%
arrange(uid, timestamp) %>%
select(u_id = uid, kapr = value, q_id = id, column)
user_questions_data
install.packages("repurrrsive")
repurrrsive::gh_users_xml()
x <- repurrrsive::gap_nested
View(x)
x <- repurrrsive::wesanderson_json()
x <- repurrrsive::wesanderson
pacman::p_load(tidyverse, rebus)
raw_user_data <- read_csv("mindfil4-3-20.csv")
actual_questions_data <- read_csv("main_section_full.csv")
raw_user_data %>% pull(type) %>% unique()
questions_info <-
actual_questions_data %>%
select(q_id = `Group ID`,
q_answer = Same,
q_type = `Record ID`) %>%
group_by(q_id) %>%
slice(1) %>%
ungroup() %>%
mutate_all(as.integer)
# each cell click info
raw_user_data %>%
filter(type == "kapr",
str_detect(extra, "record_linkage")) %>%
mutate(url = str_extract(extra, "url" %R% one_or_more(or(PUNCT, WRD))) %>% str_replace("url:", ""),
open_cell = str_extract(extra, "id:" %R% one_or_more(or(DGT, literal("-")))) %>% str_replace("id:", ""),
id = str_extract(open_cell, one_or_more(DGT)),
column_id = str_extract(open_cell, DGT %R% END) %>% as.integer(),
column = case_when(
column_id == 0 ~ "reg",
column_id == 1 ~ "fname",
column_id == 2 ~ "lname",
column_id == 3 ~ "dob",
column_id == 4 ~ "sex",
TRUE ~ "race"
)) %>%
arrange(uid, timestamp) %>%
select(u_id = uid, kapr = value, q_id = id, column)
# kapr for each user
user_kapr <-
raw_user_data %>%
filter(type == "kapr",
str_detect(extra, "record_linkage")) %>%
mutate(mode_url = extra %>% str_replace("id:" %R% one_or_more(or(DGT,PUNCT)), ""),
value = value %>% as.numeric()) %>%
group_by(uid) %>%
filter(value == max(value)) %>%
ungroup() %>%
arrange(uid) %>%
select(u_id = uid, kapr = value)
attention_test <- c(1,7,13,19,25,31)
# question level user
user_questions_data <-
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>%
filter(timestamp == max(timestamp)) %>%
ungroup() %>%
left_join(questions_info, by = "q_id") %>%
mutate(grade = ifelse(user_answer == q_answer, 1, 0),
sample = as.integer(u_id)%%10) %>%
select(-type,-timestamp, -extra) %>%
mutate_if(is.character,as.integer)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
group_by(u_id, q_id) %>% count(u_id)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
%>% count(u_id)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
count(u_id)
raw_user_data %>%
rename(u_id = uid) %>%
filter(type == "final_answer",
str_detect(extra, "record_linkage")) %>%
separate(value, into = c("q_id", "choice"), sep = "a", convert = T) %>%
mutate(q_id = q_id %>% str_replace("p", "") %>% as.integer(),
confidence = if_else(choice > 3, choice - 3, abs(choice - 4)),
user_answer = if_else(choice > 3, 1, 0),
attention = q_id %in% attention_test) %>%
count(u_id, sort = T)
raw_user_data %>% filter(uid == 2004)
raw_user_data %>% filter(uid == 2004) %>% arrange(timestamp())
##------ Wed Mar 21 12:57:10 2018 ------##
raw_user_data %>% filter(uid == 2004) %>% arrange(timestamp
)
raw_user_data %>% filter(uid == 2004) %>% arrange(timestamp) %>% View
raw_user_data %>% filter(uid == 2004) %>% View
